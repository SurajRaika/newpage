<script>
            const themeToggleButton = document.getElementById('theme-toggle');

            // Event listener for theme toggle button (now inside the more menu)
            themeToggleButton.addEventListener('click', () => {
                const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                applyTheme(newTheme);
                moreMenu.classList.remove('show'); // Close menu after selection
                // Use a timeout to hide visibility after transition completes
                setTimeout(() => {
                    moreMenu.style.visibility = 'hidden';
                    moreMenu.style.pointerEvents = 'none';
                }, 200); // Match transition-duration of opacity/transform
            });
    // Register applyTheme function globally
    window.applyTheme = function(theme) {
        const html = document.documentElement; // Target the html element for dark mode class
        const activeLine = document.getElementById('active-line'); // Get the active line element
        const themeToggleButton = document.getElementById('themeToggleButton'); // Get toggle button by ID

        if (theme === 'light') {
            html.classList.remove('dark');
            if (themeToggleButton) themeToggleButton.textContent = 'Dark Mode';
            if (activeLine) activeLine.style.backgroundColor = '#1a1a1a'; // Dark color for light mode
        } else {
            html.classList.add('dark');
            if (themeToggleButton) themeToggleButton.textContent = 'Light Mode';
            if (activeLine) activeLine.style.backgroundColor = '#ffffff'; // White for dark mode
        }

        localStorage.setItem('themePreference', theme);
    };
</script>
